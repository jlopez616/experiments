<!DOCTYPE html><html class=''>
               <head>
                   <meta charset='UTF-8'>
                   <meta name="robots" content="noindex">
                   <title>Tower of London</title>
                   <link rel='stylesheet' type='text/css' href='jspsych.css'>
                   <link rel='stylesheet' type='text/css' href='default_style.css'>
                   <link rel='stylesheet' type='text/css' href='style.css'>
                   <!-- The core Firebase JS SDK is always required and must be listed first -->
                   <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-app.js"></script>

                   <!-- TODO: Add SDKs for Firebase products that you want to use
         https://firebase.google.com/docs/web/setup#available-libraries -->
                   <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-database.js"></script>

                   <script>// Your web app's Firebase configuration
                       // For Firebase JS SDK v7.20.0 and later, measurementId is optional
          
                   </script>
               </head>

<body>
</body>

<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.4.1/math.min.js'></script>
<script src='jspsych/jspsych.js'></script>
<script src='jspsych/plugins/jspsych-text.js'></script>
<script src='jspsych/poldrack_plugins/jspsych-poldrack-text.js'></script>
<script src='jspsych/poldrack_plugins/jspsych-poldrack-instructions.js'></script>
<script src='jspsych/poldrack_plugins/jspsych-attention-check.js'></script>
<script src='jspsych/poldrack_plugins/jspsych-single-stim-button.js'></script>
<script src='jspsych/poldrack_plugins/jspsych-poldrack-single-stim.js'></script>
<script src='jspsych/plugins/jspsych-survey-text.js'></script>
<script src='jspsych/poldrack_plugins/poldrack_utils.js'></script>
<script src='experiment.js'></script>
<script>
    $(document).ready(function () {

        var firebaseConfig = {
            apiKey: "AIzaSyCtkK51gm0Gp4FLFeRKroQAegKoHkVKbbc",
            authDomain: "fball-3b968.firebaseapp.com",
            databaseURL: "https://fball-3b968-default-rtdb.firebaseio.com",
            projectId: "fball-3b968",
            storageBucket: "fball-3b968.appspot.com",
            messagingSenderId: "805120280288",
            appId: "1:805120280288:web:a6166b9c2759d11325b285",
            measurementId: "G-YKG44M8QSH"
        };
        // Initialize Firebase

        firebase.initializeApp(firebaseConfig);
        var firebaseRef = firebase.database().ref("PS20210");


    jsPsych.init({
             timeline: tower_of_london_experiment,
             display_element: "getDisplayElement",
             fullscreen: false,
             on_trial_finish: function(data){
               addID('tower-of-london')
             },

             on_finish: function(data){

                 // Serialize the data
                 var promise = new Promise(function(resolve, reject) {
                     var data = JSON.parse(jsPsych.data.dataAsJSON()) ;
                     resolve(data);
                 })

                 promise.then(function (data) {
                     console.log(data);
                     firebaseRef.push().set(data);

                     /*.ajax({
                         type: "POST",
                         url: 'https://fball-3b968-default-rtdb.firebaseio.com/test.json',
                         data: { "data": data },
                         success: function(){ document.location = "/next" },
                         dataType: "application/json",
                         // Endpoint not running, local save

                         error: function (err) {

                             if (err.status == 200) {
                                 alert(err);
                                 console.log(err);
                                document.location = "/next"
                             } else {
                                 // If error, assue local save
                                 console.log(err);
                                 alert(err);
                                 //jsPsych.data.localSave('tower-of-london_results.csv', 'csv');
                            }
                         }

                     });*/
                 })
             }

      });
});
</script>

</html>
